<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>E-CORP PENTEST TERMINAL</title>

<script>
(function() {
    try {
        const safeAlert = function(msg) {
            console.group("%c‚ö†Ô∏è [BROWSER INTERCEPT]", "background: #c00; color: white; padding: 2px 6px; border-radius: 3px; font-weight: bold;");
            console.log(`%cPopup Content: "${msg}"`, "color: #ff9999; font-size: 14px;");
            console.log("%c(Native window suppressed)", "color: gray; font-style: italic;");
            console.groupEnd();
            return true;
        };
        Object.defineProperty(window, 'alert', { value: safeAlert, writable: false });
        Object.defineProperty(window, 'confirm', { value: () => true, writable: false });
        Object.defineProperty(window, 'prompt', { value: () => "admin", writable: false });
        console.log("%cüõ°Ô∏è Anti-Popup System Active", "color: green; font-weight: bold;");
    } catch (e) {
        console.error("Anti-Popup failed:", e);
    }
})();
</script>

<style>
    body {
        background-color: #111;
        margin: 0;
        height: 100vh;
        overflow: hidden;
        font-family: 'Consolas', 'Monaco', monospace;
        display: flex;
        justify-content: center;
        align-items: center;
        color: #cccccc;
    }

    /* –ó–ú–ï–ù–®–ï–ù–ò–ô –¢–ï–†–ú–Ü–ù–ê–õ */
    .terminal-window {
        width: 700px;  /* –§—ñ–∫—Å–æ–≤–∞–Ω–∞ —à–∏—Ä–∏–Ω–∞ */
        height: 500px; /* –§—ñ–∫—Å–æ–≤–∞–Ω–∞ –≤–∏—Å–æ—Ç–∞ */
        background: #1e1e1e;
        border: 1px solid #444;
        box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        display: flex;
        flex-direction: column;
        border-radius: 6px;
    }

    .header-bar {
        background: #2d2d2d;
        padding: 8px 15px;
        font-size: 13px;
        color: #bbb;
        display: flex;
        justify-content: space-between;
        border-bottom: 1px solid #333;
        border-radius: 5px 5px 0 0;
        user-select: none;
    }

    .console-output {
        flex-grow: 1;
        padding: 15px;
        overflow-y: auto;
        font-size: 13px;
        line-height: 1.6;
        color: #d4d4d4;
    }

    .console-output p { margin: 4px 0; }

    .status-line {
        background: #007acc;
        color: white;
        padding: 4px 10px;
        font-size: 11px;
        display: flex;
        justify-content: space-between;
    }

    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #1e1e1e; }
    ::-webkit-scrollbar-thumb { background: #444; border-radius: 4px; }

    code {
        font-family: 'Consolas', monospace;
        background: #2d2d2d;
        padding: 2px 5px;
        border-radius: 3px;
        color: #ce9178;
    }
</style>
</head>
<body>

<div class="terminal-window">
    <div class="header-bar">
        <span>root@pentest-box:~</span>
        <span>E-CORP TOOLKIT v3.2</span>
    </div>
    <div class="console-output" id="output">
        <p style="color: #569cd6">Initializing connection...</p>
        <p>Connected to 192.168.1.15.</p>
        <br>
        <p><b>[TASK]</b> –ü—Ä–æ–≤–µ—Å—Ç–∏ –∞—É–¥–∏—Ç –±–µ–∑–ø–µ–∫–∏ E-CORP.</p>
        <p><b>[GOAL]</b> –û—Ç—Ä–∏–º–∞—Ç–∏ –≤–∏—Ö—ñ–¥–Ω–∏–π –∫–æ–¥ <code>index.html</code>.</p>
        <br>
        <p>> –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ <span style="color: #ce9178">Console (F12)</span>.</p>
        <p>> –í–≤–µ–¥—ñ—Ç—å <code>sys.init()</code> –¥–ª—è —Å—Ç–∞—Ä—Ç—É.</p>
        <p>> –í–≤–µ–¥—ñ—Ç—å <code>sys.help()</code> –¥–ª—è —Å–ø–∏—Å–∫—É –∫–æ–º–∞–Ω–¥.</p>
    </div>
    <div class="status-line">
        <span id="status-text">IDLE</span>
        <span>UTF-8</span>
    </div>
</div>

<script>
(function(){
    if (window.__PENTEST_INIT) return;
    window.__PENTEST_INIT = true;

    let current = 1;

    const s = {
        cmd: "color: #9cdcfe; font-weight: bold;",
        str: "color: #ce9178;",
        comment: "color: #6a9955; font-style: italic;",
        err: "color: #f44747;",
        success: "color: #b5cea8; font-weight: bold;",
        keyword: "color: #c586c0;",
        bg: "background: #222; padding: 2px;"
    };

    const levels = [
        {
            id: 1,
            name: "Auth Bypass (SQLi)",
            endpoint: "/api/auth/login",
            desc: "–§–æ—Ä–º–∞ –≤—Ö–æ–¥—É –≤—Ä–∞–∑–ª–∏–≤–∞ –¥–æ SQL Injection. –ú–∏ –º–æ–∂–µ–º–æ –∑–º—ñ–Ω–∏—Ç–∏ –ª–æ–≥—ñ–∫—É –∑–∞–ø–∏—Ç—É, —â–æ–± –≤—ñ–Ω –∑–∞–≤–∂–¥–∏ –ø–æ–≤–µ—Ä—Ç–∞–≤ –ø—Ä–∞–≤–¥—É.",
            vulnHint: `query = "SELECT * FROM users WHERE pass = '" + input + "'";`,
            fn: "login",
            hint: "–ù–∞–ø–∏—à–∏ –∑–∞–ø–∏—Ç, —è–∫–∏–π —Ä–æ–±–∏—Ç—å —É–º–æ–≤—É —ñ—Å—Ç–∏–Ω–Ω–æ—é. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π: ' OR 1=1 --",
            details: "–°–∏–º–≤–æ–ª ' –∑–∞–∫—Ä–∏–≤–∞—î —Ä—è–¥–æ–∫ –ø–∞—Ä–æ–ª—è. OR 1=1 —Ä–æ–±–∏—Ç—å —É–º–æ–≤—É —ñ—Å—Ç–∏–Ω–Ω–æ—é –¥–ª—è –≤—Å—ñ—Ö —Ä—è–¥–∫—ñ–≤. -- –∫–æ–º–µ–Ω—Ç—É—î —Ä–µ—à—Ç—É –∑–∞–ø–∏—Ç—É.",
            check: p => /or\s+1=1/i.test(p) || /--/.test(p) || /#/.test(p)
        },
        {
            id: 2,
            name: "Session Hijacking (XSS)",
            endpoint: "/support/ticket",
            desc: "Reflected XSS: –°–µ—Ä–≤–µ—Ä –≤—ñ–¥–æ–±—Ä–∞–∂–∞—î –≤–≤–µ–¥–µ–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –±–µ–∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—ó. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–æ–Ω–∞—Ç–∏ JS –∫–æ–¥.",
            vulnHint: `<div>User message: {input}</div>`,
            fn: "sendTicket",
            hint: "–í—Å—Ç–∞–≤ HTML —Ç–µ–≥, —è–∫–∏–π –≤–∏–∫–æ–Ω—É—î JavaScript. –ù–∞–ø—Ä–∏–∫–ª–∞–¥: <script>alert(1)<\/script>",
            details: "–ë—Ä–∞—É–∑–µ—Ä –±–∞—á–∏—Ç—å —Ç–µ–≥ <script> —ñ –≤–∏–∫–æ–Ω—É—î –∫–æ–¥ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –∫—Ä–∞—Å—Ç–∏ –∫—É–∫–∏ (document.cookie).",
            check: p => /<script|onerror|alert|document\.cookie/i.test(p)
        },
        {
            id: 3,
            name: "Privilege Escalation (IDOR)",
            endpoint: "/api/user/profile",
            desc: "IDOR: –°–µ—Ä–≤–µ—Ä –Ω–µ –ø–µ—Ä–µ–≤—ñ—Ä—è—î, —á–∏ –Ω–∞–ª–µ–∂–∏—Ç—å ID –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É. –ú–æ–∂–Ω–∞ –æ—Ç—Ä–∏–º–∞—Ç–∏ –¥–æ—Å—Ç—É–ø –¥–æ —á—É–∂–æ–≥–æ –ø—Ä–æ—Ñ—ñ–ª—é.",
            vulnHint: `// Server just takes ID and returns data\nreturn db.get_user(request.id)`,
            fn: "getProfile",
            hint: "–¢–≤—ñ–π ID=105 (–ì—ñ—Å—Ç—å). –ê–¥–º—ñ–Ω–∏ –∑–∞–∑–≤–∏—á–∞–π –º–∞—é—Ç—å ID=1 –∞–±–æ ID=0.",
            details: "–ü—Ä–æ—Å—Ç–æ –∑–º—ñ–Ω–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä ID —É —Ñ—É–Ω–∫—Ü—ñ—ó –Ω–∞ 0 –∞–±–æ 1.",
            check: id => Number(id) === 1 || Number(id) === 0
        },
        {
            id: 4,
            name: "File Disclosure (LFI)",
            endpoint: "/system/logs",
            desc: "Path Traversal: –î–æ–¥–∞—Ç–æ–∫ –¥–æ–∑–≤–æ–ª—è—î —á–∏—Ç–∞—Ç–∏ —Ñ–∞–π–ª–∏ –∑–∞ –≤–∫–∞–∑–∞–Ω–∏–º —à–ª—è—Ö–æ–º –±–µ–∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ø–∞–ø–∫–∏.",
            vulnHint: `path = "/var/www/logs/" + filename`,
            fn: "readLog",
            hint: "–¢–æ–±—ñ —Ç—Ä–µ–±–∞ –≤–∏–π—Ç–∏ –∑ –ø–∞–ø–∫–∏ 'logs' –Ω–∞ —Ä—ñ–≤–µ–Ω—å –≤–∏—â–µ. –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π '../index.html'",
            details: "'..' –≤ —à–ª—è—Ö—É –æ–∑–Ω–∞—á–∞—î '–±–∞—Ç—å–∫—ñ–≤—Å—å–∫–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—è'. –¶–µ –¥–æ–∑–≤–æ–ª—è—î –≤–∏–π—Ç–∏ –∑–∞ –º–µ–∂—ñ –¥–æ–∑–≤–æ–ª–µ–Ω–æ—ó –ø–∞–ø–∫–∏.",
            check: p => p.includes("..")
        }
    ];

    function log(msg, style = "") { console.log(`%c${msg}`, style); }
    function serverLog(code, msg) { console.log(`%c[SERVER] HTTP ${code} ${msg}`, code===200 ? s.success : s.err); }

    function renderCodePreview(codeSnippet) {
        console.groupCollapsed("%cüîé [–í–†–ê–ó–õ–ò–í–ò–ô –ö–û–î] - –ù–∞—Ç–∏—Å–Ω–∏, —â–æ–± –ø–æ–¥–∏–≤–∏—Ç–∏—Å—å", s.comment);
        console.log(`%c${codeSnippet}`, "color: #d4d4d4; background: #1e1e1e; padding: 10px; display: block; font-family: monospace;");
        console.groupEnd();
    }

    function showLevel() {
        if (current > levels.length) {
            console.clear();
            console.log("%c üéâ PENTEST COMPLETE. ", "background: green; color: white; font-size: 20px; padding: 10px;");
            document.getElementById('status-text').innerText = "DONE";
            return;
        }
        const L = levels[current-1];
        console.log(`%c\n--- [LEVEL ${current}] ${L.name} ---`, "color: white; font-weight: bold; border-bottom: 1px solid #555;");
        log(`> Endpoint: ${L.endpoint}`, s.keyword);
        log(`> Info: ${L.desc}`);

        if(L.vulnHint) renderCodePreview(L.vulnHint);

        log(`\n–î–æ—Å—Ç—É–ø–Ω–∞ –∫–æ–º–∞–Ω–¥–∞: sys.${L.fn}(payload)`, s.cmd);
        log(`(–í–≤–µ–¥–∏ sys.hint() —è–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞)`, "color: gray; font-size: 10px;");

        document.getElementById('status-text').innerText = `MOD: ${L.name}`;
    }

    function next() {
        log(`\n[+] –£—Å–ø—ñ—Ö. –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –º–æ–¥—É–ª—è...`, s.success);
        current++;
        setTimeout(showLevel, 1500);
    }

    function fail(reason) { log(`[-] –ü–æ–º–∏–ª–∫–∞: ${reason}`, s.err); }

    function init() {
        current = 1;
        console.clear();
        log("–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –º–æ–¥—É–ª—ñ–≤...", s.comment);
        setTimeout(showLevel, 1000);
    }

    // –ù–æ–≤–∞ —Ñ—É–Ω–∫—Ü—ñ—è –ø—ñ–¥–∫–∞–∑–æ–∫
    function hint() {
        if (current > levels.length) return;
        const L = levels[current-1];
        console.log(`%cüí° –ü–Ü–î–ö–ê–ó–ö–ê: ${L.hint}`, "color: yellow; font-weight: bold;");
        console.log(`%cüìñ –î–ï–¢–ê–õ–Ü: ${L.details}`, "color: #aaa; font-style: italic;");
    }

    function help() {
        console.log("%c–î–æ—Å—Ç—É–ø–Ω—ñ –∫–æ–º–∞–Ω–¥–∏:", "color: white; font-weight: bold;");
        console.log("  sys.init()       - –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–∏ –≥—Ä—É");
        console.log("  sys.hint()       - –û—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–¥–∫–∞–∑–∫—É –¥–ª—è —Ä—ñ–≤–Ω—è");
        console.log("  sys.help()       - –¶–µ –º–µ–Ω—é");
        console.log("  ---------------------------------");
        levels.forEach(l => {
             console.log(`  sys.${l.fn}(...) - ${l.name}`);
        });
    }

    // --- LEVEL LOGIC ---

    function login(payload) {
        if(levels[current-1].id !== 1) return fail("–ù–µ —Ç–æ–π –º–æ–¥—É–ª—å.");
        console.group("SQL Query Executed:");
        log(`SELECT * FROM users WHERE pass = '${payload}'`, s.str);
        if(levels[0].check(payload)) {
            log("‚úÖ SQLi Success: –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ —è–∫ Admin", s.success);
            console.groupEnd();
            next();
        } else {
            log("‚ùå Access Denied", s.err);
            console.groupEnd();
            fail("–ó–∞–ø–∏—Ç –ø–æ–≤–µ—Ä–Ω—É–≤ false");
        }
    }

    function sendTicket(payload) {
        if(levels[current-1].id !== 2) return fail("–ù–µ —Ç–æ–π –º–æ–¥—É–ª—å.");
        console.group("Admin Browser View:");
        log(`Rendered HTML: ${payload}`, "color: gray");

        if(levels[1].check(payload)) {
            log("‚ö†Ô∏è XSS Detected!", "color: orange");
            if(payload.includes("alert")) window.alert("XSS!");
            log("‚úÖ Cookies Stolen successfully", s.success);
            console.groupEnd();
            next();
        } else {
            log("‚ùå –ë–µ–∑–ø–µ—á–Ω–∏–π —Ä–µ–Ω–¥–µ—Ä (–∫–æ–¥ –Ω–µ –≤–∏–∫–æ–Ω–∞–≤—Å—è)", s.comment);
            console.groupEnd();
            fail("JS –Ω–µ —Å–ø—Ä–∞—Ü—é–≤–∞–≤");
        }
    }

    function getProfile(id) {
        if(levels[current-1].id !== 3) return fail("–ù–µ —Ç–æ–π –º–æ–¥—É–ª—å.");
        log(`GET /api/user/${id}`, s.cmd);
        if(levels[2].check(id)) {
            log("‚úÖ –î–∞–Ω—ñ –ê–¥–º—ñ–Ω–∞ –æ—Ç—Ä–∏–º–∞–Ω–æ!", s.success);
            next();
        } else {
            log("‚ùå –î–∞–Ω—ñ –ì–æ—Å—Ç—è (Guest)", s.err);
            fail("–ü–æ—Ç—Ä—ñ–±–µ–Ω ID –∞–¥–º—ñ–Ω–∞");
        }
    }

    function readLog(filename) {
        if(levels[current-1].id !== 4) return fail("–ù–µ —Ç–æ–π –º–æ–¥—É–ª—å.");

        const path = "/var/www/logs/" + filename;
        console.log(`%c[SYSTEM] Reading: ${path}`, s.comment);

        if(!levels[3].check(filename)) {
            serverLog(404, "File not found");
            fail("–§–∞–π–ª –º–∞—î –±—É—Ç–∏ –∑–∞ –º–µ–∂–∞–º–∏ /logs/ (–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–π ../)");
            return;
        }

        if(filename.includes("index.html")) {
            serverLog(200, "OK");
            log("‚úÖ –§–ê–ô–õ –û–¢–†–ò–ú–ê–ù–û:", s.success);
            console.group("%cüìÑ SOURCE CODE (index.html)", "color: black; background: #00ff41; padding: 2px 5px;");
            console.log(document.documentElement.outerHTML);
            console.groupEnd();
            next();
        } else {
            serverLog(200, "OK");
            log(`[Binary content]`, "color: gray");
            log("‚ùå –¶–µ –Ω–µ index.html", s.err);
        }
    }

    window.sys = { init, login, sendTicket, getProfile, readLog, hint, help };
    console.log("%c System Ready. Type sys.init()", "background: #007acc; color: white; padding: 4px;");

})();
</script>
</body>
</html>
